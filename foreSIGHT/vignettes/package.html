<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Dr Bree Bennett, Sam Culley" />

<meta name="date" content="2017-12-05" />

<title>A quick tour of exposure</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,%0Abody%7B%0Afont%2Dfamily%3A%20helvetica%2C%20arial%2C%20freesans%2C%20clean%2C%20sans%2Dserif%3B%0Acolor%3A%20%23333%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%3A%20none%3B%0Aline%2Dheight%3A%201%2E5%3B%0Amargin%3A%202em%203em%3B%0Atext%2Dalign%3Aleft%3B%0A%7D%0Apre%7B%0Abackground%2Dcolor%3A%20%23eee%3B%0Apadding%3A%2010px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%205px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%205px%3B%0Aborder%2Dradius%3A%205px%3B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%7B%0Abackground%2Dcolor%3A%20%23eee%3B%0Apadding%3A%201px%203px%3B%0A%2Dwebkit%2Dborder%2Dradius%3A%202px%3B%0A%2Dmoz%2Dborder%2Dradius%3A%202px%3B%0Aborder%2Dradius%3A%202px%3B%09%7D%0Ali%20p%7B%0Amargin%3A%200%2E3em%3B%0A%7D%0Ali%7B%0Alist%2Dstyle%2Dtype%3A%20disc%3B%0A%7D%0Aa%3Alink%2C%20a%3Avisited%7B%0Acolor%3A%20%2333e%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%7B%0Acolor%3A%20%2300f%3B%0Atext%2Dshadow%3A1px%201px%202px%20%23ccf%3B%0Atext%2Ddecoration%3Aunderline%3B%0A%7D%0Ah1%7B%0Acolor%3A%20%23999%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah2%7B%0Aborder%2Dbottom%3A%201px%20dotted%20%23aaa%3B%0Amargin%2Dbottom%3A%201em%3B%0Acolor%3A%20%23333%3B%0A%7D%0Ah3%7B%0Acolor%3A%20%23666%3B%0A%7D%0A%2Eshadow%7B%0A%2Dwebkit%2Dbox%2Dshadow%3A0%205px%2015px%20%23000%3B%0A%2Dmoz%2Dbox%2Dshadow%3A0%205px%2015px%20%23000%3B%0Abox%2Dshadow%3A0%205px%2015px%20%23000%3B%09%7D%0A%2Ehll%20%7B%20background%2Dcolor%3A%20%23ffffff%20%7D%0A%2Ec%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%20%7D%20%0A%2Eerr%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%20%7D%20%0A%2Ek%20%7B%20color%3A%20%23000000%3B%20font%2Dweight%3A%20bold%20%7D%20%0A%2Ecm%20%7B%20color%3A%20%23888888%20%7D%20%0A%2Ecp%20%7B%20color%3A%20%23cc0000%3B%20font%2Dweight%3A%20bold%20%7D%20%0A%2Ec1%20%7B%20color%3A%20%23888888%20%7D%20%0A%2Ecs%20%7B%20color%3A%20%23cc0000%3B%20font%2Dweight%3A%20bold%3B%20background%2Dcolor%3A%20%23fff0f0%20%7D%20%0A%2Egd%20%7B%20color%3A%20%23000000%3B%20background%2Dcolor%3A%20%23ffdddd%20%7D%20%0A%2Ege%20%7B%20font%2Dstyle%3A%20italic%20%7D%20%0A%2Egr%20%7B%20color%3A%20%23aa0000%20%7D%20%0A%2Egh%20%7B%20color%3A%20%23303030%20%7D%20%0A%2Egi%20%7B%20color%3A%20%23000000%3B%20background%2Dcolor%3A%20%23ddffdd%20%7D%20%0A%2Ego%20%7B%20color%3A%20%23888888%20%7D%20%0A%2Egp%20%7B%20color%3A%20%23555555%20%7D%20%0A%2Egs%20%7B%20font%2Dweight%3A%20bold%20%7D%20%0A%2Egu%20%7B%20color%3A%20%23606060%20%7D%20%0A%2Egt%20%7B%20color%3A%20%23aa0000%20%7D%20%0A%2Ehighlight%20%2Ekc%7Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Ekd%7Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Ekn%7Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Ekp%7Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Ekr%7Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Ekt%7Bcolor%3A%23458%3Bfont%2Dweight%3Abold%3B%7D%20%0A%2Es%20%7B%20color%3A%20%23dd2200%3B%20background%2Dcolor%3A%20%23fff0f0%20%7D%20%0A%2Ehighlight%20%2Ena%7Bcolor%3A%23008080%3B%7D%20%0A%2Ehighlight%20%2Enb%7Bcolor%3A%230086B3%3B%7D%20%0A%2Ehighlight%20%2Enc%7Bcolor%3A%23458%3Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Eno%7Bcolor%3A%23008080%3B%7D%20%0A%2Ehighlight%20%2Eni%7Bcolor%3A%23800080%3B%7D%20%2Ehighlight%20%2Ene%7Bcolor%3A%23900%3Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Enf%7Bcolor%3A%23900%3Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Enn%7Bcolor%3A%23005%3Bfont%2Dweight%3Abold%3B%7D%20%0A%2Ehighlight%20%2Ent%7Bcolor%3A%23000080%3B%7D%20%0A%2Ehighlight%20%2Env%7Bcolor%3A%23008080%3B%7D%20%0A%2Epy%20%7B%20color%3A%20%23336699%3B%20font%2Dweight%3A%20bold%20%7D%20%0A%2Eow%20%7B%20color%3A%20%23008800%20%7D%20%0A%2Ew%20%7B%20color%3A%20%23bbbbbb%20%7D%20%0A%2Ehighlight%20%2Emi%20%7Bcolor%3A%23099%3B%7D%20%0A%2Esb%20%7B%20color%3A%20%23dd2200%3B%20background%2Dcolor%3A%20%23fff0f0%20%7D%20%0A%2Ehighlight%20%2Esc%7Bcolor%3A%23d14%3B%7D%20%0A%2Esd%20%7B%20color%3A%20%23dd2200%3B%20background%2Dcolor%3A%20%23fff0f0%20%7D%20%0A%2Ehighlight%20%2Es2%7Bcolor%3A%23d14%3B%7D%20%0A%2Ehighlight%20%2Ese%7Bcolor%3A%23d14%3B%7D%20%0A%2Ehighlight%20%2Esh%7Bcolor%3A%23d14%3B%7D%20%0A%2Ehighlight%20%2Esi%7Bcolor%3A%23d14%3B%7D%20%0A%2Ehighlight%20%2Esx%7Bcolor%3A%23d14%3B%7D%20%0A%2Ehighlight%20%2Esr%7Bcolor%3A%23d14%3B%7D%20%0A%2Ehighlight%20%2Es1%7Bcolor%3A%23d14%3B%7D%20%0A%2Ehighlight%20%2Ess%7Bcolor%3A%23d14%3B%7D%20%0A%2Ebp%20%7B%20color%3A%20%23003388%20%7D%20%0A%2Evc%20%7B%20color%3A%20%23336699%20%7D%20%0A%2Evg%20%7B%20color%3A%20%23dd7700%20%7D%20%0A%2Evi%20%7B%20color%3A%20%233333bb%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">A quick tour of exposure</h1>
<h4 class="author"><em>Dr Bree Bennett, Sam Culley</em></h4>
<h4 class="date"><em>22/05/17</em></h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>A scenario neutral approach to climate change impact analyses.</p>
<p><span class="math display">\[
OF=\sqrt{\sum_{i=1}^n(t_i-a_{si})^2}
\]</span> where <span class="math inline">\(t_i\)</span> is a vector of the desired attributes, <span class="math inline">\(a_{si}\)</span> is a vector of calcualted attributes for a simulated time series, and <span class="math inline">\(n\)</span> attributes are requested. The argument attSel controls the requested attributes, with a full list available in the documentation.</p>
<p>This document gives a quick tour of <strong>exposure</strong> (version 0.1) functionalities. It was written in R Markdown, using the <a href="http://cran.r-project.org/package=knitr">knitr</a> package for production.</p>
</div>
<div id="exposure-spaces" class="section level1">
<h1>Exposure Spaces</h1>
<p>This package outputs the necessary data to create exposure spaces. Each output file is a time series with daily entries of the requested variables. The files are titled by their “co-ordinates” in the exposure space, which are the same as the requested targets. e.g. “1.1P-ann-tot-m_3Temp-ann-avg-m.csv”</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The argument ExSpArgs is responsible for shaping an exposure space, with “type” = “regGrid”. “samp” indicates the number of points on each axis, and “bounds” provides the min and max values on each axis. To specify which attributes should become an axis, enter them in attPrim, a vector of Primary attributes. For example, the above space would have arguments:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">attSel&lt;-attPrim&lt;-<span class="kw">c</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>,<span class="st">&quot;Temp_ann_avg_m&quot;</span>)     <span class="co">#In this case all specified attributes are on an axis</span>

exSpArgs&lt;-<span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;regGrid&quot;</span>,
               <span class="dt">samp =</span> <span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">6</span>),
               <span class="dt">bounds =</span> <span class="kw">list</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>=<span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">1.5</span>), <span class="co">#bounds entries match the order in attSel</span>
                             <span class="st">&quot;Temp_ann_avg_m&quot;</span>=<span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">4</span>)))</code></pre></div>
</div>
<div id="example---simple-scaling" class="section level1">
<h1>Example - Simple Scaling</h1>
<p>One of the simplest ways to produce an exposure space is to simply scale the historical data records. In these instances P and PET are changed by a percentage, and temperature is changed additively. These changes occur at the daily time step. This package has the functionality to make simply scaled scenarios, by using the model tag “Simple-ann”.</p>
<p>With this model techique, the complexity of attributes that can be altered is very limited. Each day in the historical time series is changed by the same amount. For this reason, simple scaling only supports changes to P and PET annual totals, and Temp annual averages. For this reason, attSel and attPrim are the same, and only have one entry per variable requested.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelTag=<span class="st">&quot;Simple-ann&quot;</span>

attSel&lt;-attPrim&lt;-<span class="kw">c</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>,<span class="st">&quot;Temp_ann_avg_m&quot;</span>)

exSpArgs&lt;-<span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;regGrid&quot;</span>,
               <span class="dt">samp =</span> <span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">6</span>),
               <span class="dt">bounds =</span> <span class="kw">list</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>=<span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">1.5</span>),
                             <span class="st">&quot;Temp_ann_avg_m&quot;</span>=<span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">4</span>)))</code></pre></div>
<p>This request of exSpArgs would produce the data for an exposure space identical to the one shown above. Note that due to historical scaling, the data will be of the same length of the observed record.</p>
</div>
<div id="example---stochastic-rainfall-temperature" class="section level1">
<h1>Example - Stochastic Rainfall Temperature</h1>
<p>For climate scenarios longer than the observed historical record, or manipulations of more complex attributes, stochastic weather generators must be used. In supplying a stochastic model tag for a variable, like “P-ann-wgen” for precipitaiton, the options of attributes to include in attSel will increase. However, the complete list of supported attributes will not work for all model types, due to different periods of analysis, or the internal structure of the model itself. Be sure to check the package documentation for valid and invalid model/attribute combinations.</p>
<p>Another implication of using stochastic models is that an optimisation algorithm must be used to direct the model parameters to produce the target climate conditions. This algorithm is controlled by the argument optimArgs. See the package documentation for more explanation of each element. The defaults are shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">optimArgs&lt;-<span class="kw">list</span>(<span class="dt">pcrossover=</span><span class="fl">0.8</span>,
                <span class="dt">pmutation=</span><span class="fl">0.1</span>,
                <span class="dt">maxiter=</span><span class="dv">40</span>,
                <span class="dt">maxFitness=</span>-<span class="fl">0.001</span>,
                <span class="dt">popSize=</span><span class="dv">100</span>,
                <span class="dt">run=</span><span class="dv">15</span>,
                <span class="dt">parallel=</span><span class="ot">FALSE</span>,
                <span class="dt">keepBest=</span><span class="ot">TRUE</span>,
                <span class="dt">lambda.mult=</span><span class="dv">0</span>)</code></pre></div>
<p>This optimisation algorithm uses an objective function of the form:</p>
<p><span class="math display">\[
OF=\sqrt{\sum_{i=1}^n(t_i-a_{si})^2}
\]</span></p>
<p>where the n attributes are provided in attSel, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelTag=<span class="kw">c</span>(<span class="st">&quot;P-ann-wgen&quot;</span>,<span class="st">&quot;Temp-har26-wgen&quot;</span>)

attSel&lt;-<span class="kw">c</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>,<span class="st">&quot;Temp_ann_avg_m&quot;</span>,<span class="st">&quot;Temp_ann_P5_m&quot;</span>,<span class="st">&quot;Temp_ann_P95_m&quot;</span>)

attPrim&lt;-<span class="kw">c</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>,<span class="st">&quot;Temp_ann_avg_m&quot;</span>)

exSpArgs&lt;-<span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;regGrid&quot;</span>,
               <span class="dt">samp =</span> <span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>),
               <span class="dt">bounds =</span> <span class="kw">list</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>=<span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">1.5</span>),
                             <span class="st">&quot;Temp_ann_avg_m&quot;</span>=<span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">4</span>),
                             <span class="st">&quot;Temp_ann_P5_m&quot;</span>=<span class="dv">1</span>,
                             <span class="st">&quot;Temp_ann_P95_m&quot;</span>=<span class="dv">1</span>))</code></pre></div>
<p>Here, it is only requested than P_ann_tot_m and Temp_ann_avg_m are pertrubed on the axis of an exposure space, despite having additional terms in the objective function. These terms can ‘dilute’ the information the optimisation algorim recieves about guiding each attribute, causing good fits with some and not others. To help guide the algorithm, optimisation runs are used for one variable at a time. This effectivly forms subsets of the objective function equation. A further effort to prioritise the primary attributes is to add penalty terms to the objective function of the form:</p>
<p><span class="math display">\[
OF=\sqrt{\sum_{i=1}^n(t_i-a_{si})^2}+\lambda*(t_p-a_p)
\]</span></p>
<p>where <span class="math inline">\(t_p\)</span> and <span class="math inline">\(a_p\)</span> are additional terms for the primary attributes. While some experiments will aim to hold attributes constant while making an exposure space, there is also a structural reason to include more in attSel than attPrim. Using the inverse approach to guide a weather generator can sometimes lack enough information to preserve the realism of the stochastic data. For example, focussing just on Temp average, without considering T5 and T95, means that while the average temperature is correct the amplitude of the temperature pattern is not constrained. This can result in temperature values in peak summer and winter that are not realistic in any sense.</p>
</div>
<div id="example---rainfall-with-two-primary-attributes" class="section level1">
<h1>Example - Rainfall with two primary attributes</h1>
<p>In the previous example, each variable was treated with its own optimisation run. This meant that there was only one primary attribute to focus on each time. However there will be many cases where different attributes of a single variable are needed to be perturbed separately. In this case the optimisation problem is more challenging, as a small number of parameters is trying to change multiple attributes separately. The below example shows a case where the extremes of rainfall are to be perturbed separately from the annual total, while holding the maximum dry spell durations constant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelTag=<span class="kw">c</span>(<span class="st">&quot;P-ann-wgen&quot;</span>)

attSel&lt;-attPrim&lt;-<span class="kw">c</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>,<span class="st">&quot;P_ann_P99_m&quot;</span>,<span class="st">&quot;P_ann_maxDSD_m&quot;</span>)

attPrim&lt;-<span class="kw">c</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>,<span class="st">&quot;P_ann_P99_m&quot;</span>)

exSpArgs&lt;-<span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;regGrid&quot;</span>,
               <span class="dt">samp =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>),
               <span class="dt">bounds =</span> <span class="kw">list</span>(<span class="st">&quot;P_ann_tot_m&quot;</span>=<span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">1.1</span>),
                             <span class="st">&quot;P_ann_P99_m&quot;</span>=<span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">1.1</span>),
                             <span class="st">&quot;P_ann_maxDSD_m&quot;</span>=<span class="dv">1</span>))</code></pre></div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Guo, D., S. Westra, and H. R. Maier (2016), An inverse approach to perturb historical rainfall data for scenario-neutral climate impact studies, Journal of Hydrology.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
